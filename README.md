# Курс "ASP.NET Core Web API микросервисы"
## Урок 1. Повторение ООП. Первый микросервис.
Написать свой контроллер и методы в нем, которые бы предоставляли следующую функциональность:
- Возможность сохранить температуру в указанное время
- Возможность отредактировать показатель температуры в указанное время
- Возможность удалить показатель температуры в указанный промежуток времени
- Возможность прочитать список показателей температуры за указанный промежуток времени

## Урок 2. REST API и тесты.
1. Добавьте метод в контроллер агентов проекта, относящегося к менеджеру метрик, который
позволяет получить список зарегистрированных в системе объектов.
2. В проект агента сбора метрик добавьте контроллеры для сбора метрик, аналогичные
менеджеру сбора метрик. Добавьте методы для получения метрик с агента, доступные по
следующим путям:
    - api/metrics/cpu/from/{fromTime}/to/{toTime}.
    - api/metrics/dotnet/errors-count/from/{fromTime}/to/{toTime}.
    - api/metrics/network/from/{fromTime}/to/{toTime}.
    - api/metrics/hdd/left/from/{fromTime}/to/{toTime}.
    - api/metrics/ram/available/from/{fromTime}/to/{toTime}.
3. Добавьте проект с тестами для агента сбора метрик. Напишите простые Unit-тесты на каждый
метод отдельно взятого контроллера в обоих тестовых проектах.

## Урок 3. Работа с базами данных.
1. Добавьте логирование всех параметров в каждом из контроллеров в обоих проектах.
2. Добавьте репозитории для каждого типа метрик в сервис агент сбора метрик.
3. Добавьте обработчики в контроллеры в REST стиле для наполнения метриками базы данных.
4. Добавьте тесты на все контроллеры и все методы с использованием заглушек.

## Урок 4. Архитектура современного микросервиса.
1. Перепишите все репозитории в приложении сбора метрик и в приложении менеджере метрик на использование Dapper вместо сырого чтения данных.
2. Настройте AutoMapper для всех остальных объектов в приложениях.

## Урок 5. Сервис-агент сбора системных метрик.
1. Реализуйте задачи для сбора метрик RAM (RamMetricsJob), HDD (HddMetricsJob) и
gc-heap-size (DotnetMetricsJob), Network (NetworkMetricJob). Сделайте это, воспользовавшись
perfomance-counters. Важно, чтобы задачи собирали метрики раз в пять секунд и записывали
их в созданную базу данных.
2. Реализуйте контроллеры, которые будут отдавать данные по собираемым метрикам.
3. Используйте FluentMigrator.

## Урок 6. Запросы между сервисами.
1. Подключите работу с базой данных к приложению менеджера сбора метрик. Все таблицы Metrics Manager должны повторять таблицы Metrics Agent, но иметь дополнительный столбец agentId (для связи метрики с агентом). Таблица Agents Должна иметь два столбца - AgentId и AgentUrl.
2. Реализуйте в Metrics Quarz Job. Сделайте Job на каждый типа метрик (как и для агента). Инъектируйте в Job репозиторий работы с агентами, репозиторий работы с соответствующей метрикой, и IMetricsAgentClient. Читайте из базы всех агентов и для каждого в цикле вызывайте методы получения метрик с агента. ApiRequest будет содержать URL агента (вы возьмете его из свойства AgentUrl в базе) и дату начала выборки и дату конца. В качестве даты конца можно брать DateTime.UtcNow. В качестве даты начала - максимальную из дат, сохраненных в БД метрик на менеджере (сделайте соответствующий запрос к базе метрик к нужной таблице). Прочитанные данные из IMetricsAgentClient сохраните в базе данных менеджера, используя репозиторий метрики.
3. Реализуйте методы GET контроллеров MetricsManager так, чтобы они по аналогии с MetricsAgent, ходили в свою базу данных и возвращали метрики.
